{% extends 'partials/base.html' %}
{% block title %}Usuarios{% endblock %}

{% block content %}

{% include 'partials/topnav.html' %}

<div class="container my-4">
  {% if messages %}
    <div class="row">
      <div class="col-12">
        {% for message in messages %}
          <div
            class="alert {% if message.tags == 'success' %}alert-success{% elif message.tags == 'error' %}alert-danger{% else %}alert-info{% endif %} shadow-lg p-3 mb-4 rounded"
            role="alert"
          >
            <h5 class="text-center fw-bold mb-0">
              {% if message.tags == 'success' %}
                <i class="fas fa-check-circle"></i>
              {% elif message.tags == 'error' %}
                <i class="fas fa-exclamation-triangle"></i>
              {% else %}
                <i class="fas fa-info-circle"></i>
              {% endif %}
              {{ message }}
            </h5>
          </div>
        {% endfor %}
      </div>
    </div>
  {% endif %}

  <div class="row">
    <div class="col-12">
      <div class="card shadow-sm border-0">
        <div class="card-header text-white text-center" style="background-color: #5A2E1B; font-weight: bold;">
          Gestión de Usuarios
        </div>
        <div class="card-body bg-white p-0">
          <table class="table table-hover mb-0">
            <thead class="text-white text-center" style="background-color: #8B4513;">
              <tr>
                <th>Nombre</th>
                <th>Email</th>
                <th>Teléfono</th>
                <th>Acciones</th>
              </tr>
            </thead>
            <tbody>
              {% for trabajador in trabajadores %}
                {% if not trabajador.is_superuser %}
                  <tr class="text-center">
                    <td>{{ trabajador.username }}</td>
                    <td>{{ trabajador.email }}</td>
                    <td>{{ trabajador.profile.telefono|default:"—" }}</td>
                    <td>
                      <a
                        href="{% url 'dashboard-staff-detalles' trabajador.id %}"
                        class="btn btn-sm"
                        style="background-color: #A0522D; color: #FFF;"
                      >
                        Ver
                      </a>
                      <a
                        href="{% url 'dashboard-staff-delete' trabajador.id %}"
                        class="btn btn-sm"
                        style="background-color: #8B0000; color: #FFF;"
                      >
                        Eliminar
                      </a>
                    </td>
                  </tr>
                {% endif %}
              {% empty %}
                <tr>
                  <td colspan="4" class="text-center text-muted py-4">
                    No hay usuarios registrados.
                  </td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>

{% endblock %}
